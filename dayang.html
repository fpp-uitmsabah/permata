<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio: Dr. Dayang Haryani Diana Ag Damit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/qr-code-styling@1.9.2/lib/qr-code-styling.js"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .back-button {
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .back-button:hover {
            transform: translateX(-4px);
            background-color: rgba(255, 255, 255, 0.2);
        }
        .profile-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            position: relative;
            overflow: hidden;
        }
        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0'0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        /* Enhanced scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #2dd4bf, #0d9488);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #14b8a6, #0f766e);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div id="app" class="min-h-screen">
        <div id="profileView">
            </div>
    </div>

    <script>
                // *** ENHANCEMENT: Make QR code instance globally accessible ***
        let qrCodeInstance = null;
        
const profileData = {
            name: "Dr. Dayang Haryani Diana Ag Damit",
            title: "Senior Lecturer",
            faculty: "Faculty of Business Management",
            institution: "Universiti Teknologi MARA (UiTM), Sabah",
            since: "April 15, 2009",
            imageUrl: "https://i.imgur.com/Q66orWt.jpeg",
            summary: "A distinguished academic and Senior Lecturer at UiTM Sabah with over 15 years of experience. Dr. Damit is a leading expert in Marketing, Halal Food Marketing, and Consumer Behavior, particularly focusing on non-Muslim consumer engagement. She is a recognized institutional leader, serving as the Head of Study Centre for Diploma Programs and founder of the 'RISE' research and consultancy group. Her impactful scholarly work is evidenced by a Google Scholar h-index of 6 and over 750 citations, reflecting her growing influence in academia and her role as an academic entrepreneur bridging research with real-world application.",
            education: [
                {
                    degree: "PhD in Technology Management (Marketing)",
                    institution: "Universiti Tun Hussein Onn Malaysia (UTHM)",
                    thesis: "Understanding the attitude and repurchase intention towards halal food product among non-muslim consumers in Malaysia."
                },
                {
                    degree: "Master of Business Administration (MBA)",
                    institution: "Universiti Putra Malaysia"
                },
                {
                    degree: "Bachelor of Business Administration (Hons) in Marketing",
                    institution: "Universiti Teknologi MARA (UiTM), Cawangan Sabah",
                    honors: "Second Class Upper"
                },
                {
                    degree: "Diploma in Business Studies",
                    institution: "Universiti Teknologi MARA (UiTM), Cawangan Sabah"
                }
            ],
            research_pillars: [
                {
                    pillar: "Halal Marketing & Non-Muslim Consumer Behavior",
                    description: "Pioneering research into the attitudes, perceptions, and purchase intentions of non-Muslim consumers towards Halal products, framing Halal as a global symbol of quality and safety."
                },
                {
                    pillar: "Entrepreneurship & SME Development",
                    description: "Investigates the critical factors driving entrepreneurial intention among students and addresses the specific growth challenges faced by SMEs, particularly within the economic landscape of Sabah."
                },
                {
                    pillar: "Leadership & Organizational Behavior",
                    description: "Examines the dynamics of leadership within academic institutions, focusing on how psychological empowerment mediates the relationship between leadership styles and employee performance."
                }
            ],
            scholarly_impact: {
                metrics: {
                    google_scholar_citations: 755,
                    citations_since_2020: 646,
                    h_index_google: 6,
                    publications: "Multiple international journals and book chapters"
                },
                seminal_work: {
                    title: "Determinants of entrepreneurial intention among undergraduate students in Malaysia",
                    year: 2016,
                    citations: 464,
                    impact: "A foundational text in the field of entrepreneurship education in Southeast Asia, identifying personal attitude and relational support as key predictors of entrepreneurial intent."
                }
            },
            key_publications: [
                {
                    title: "Determinants of entrepreneurial intention among undergraduate students in Malaysia",
                    journal: "Procedia Economics and Finance",
                    year: 2016,
                    citations: 464,
                    significance: "landmark"
                },
                {
                    title: "The mediating effect of psychological empowerment on leadership styles and task performance of academic staff",
                    journal: "Leadership & Organization Development Journal",
                    year: 2021,
                    citations: 94,
                    significance: "key"
                },
                {
                    title: "What makes a non-Muslim purchase halal food in a Muslim country? An application of theory of planned behaviour",
                    journal: "Management Science Letters",
                    year: 2019,
                    citations: 83,
                    significance: "key"
                },
                {
                    title: "Growth challenges of SMEs: empirical evidence in Sabah, Malaysia",
                    journal: "ASEAN Entrepreneurship Journal",
                    year: 2020,
                    citations: 49,
                    significance: "regional"
                }
            ],
            leadership_and_service: {
                institutional: [
                    "Head of Study Centre, Faculty of Business and Management (Diploma Programs)",
                    "Founder of 'RISE', a special interest group for national and international research and consultancy."
                ],
                community: [
                    "Program Advisor at Politkenik Kota Kinabalu",
                    "Program Advisor at SIDMA College",
                    "Member of the Chartered Institute of Marketing",
                    "Certified Management and Business Educator (CMBE)"
                ]
            },
            mentorship: {
                phd_graduated: 4,
                postgrad_examined: "10+",
                supervising_now: "4 PhD, 1 Master's",
                achievements: [
                    "Outstanding Supervisor Award (2022)"
                ]
            },
            awards_and_innovations: [
                "Best Researcher Award (2022)",
                "UiTM Top Talent Award (2022)",
                "Outstanding Supervisor Award (2022)",
                "Best Paper Award",
                "Best Presenter Award",
                "Holder of more than 20 innovation awards at national and international levels.",
                "Innovator of the 'SMART Hygiene Kit'."
            ]
        };

                function toggleShare() {
            const panel = document.getElementById('sharePanel');
            if (panel.classList.contains('translate-x-full')) {
                panel.classList.remove('translate-x-full');
            } else {
                panel.classList.add('translate-x-full');
            }
        }

        // Close panel when clicking outside
        document.addEventListener('click', function(event) {
            const panel = document.getElementById('sharePanel');
            const trigger = document.querySelector('button[onclick="toggleShare()"]');
            if (panel && !panel.classList.contains('translate-x-full') && !panel.contains(event.target) && trigger && !trigger.contains(event.target)) {
                panel.classList.add('translate-x-full');
            }
        });

        // *** ENHANCEMENT: New function to download the QR code ***
        function downloadQR() {
            if (qrCodeInstance) {
                const fileName = document.title.replace(/Portfolio:\s*/i, '').replace(/[^a-z0-9]/gi, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');
                qrCodeInstance.download({ name: fileName + "-Portfolio-QR", extension: "png" });
            } else {
                alert("QR Code is not ready yet. Please wait a moment and try again.");
            }
        }
        
        // *** ENHANCEMENT: New function for Web Share API (native mobile sharing) ***
        function shareLinkNative() {
            if (navigator.share) {
                navigator.share({
                    title: document.title,
                    text: "Check out this amazing portfolio!",
                    url: window.location.href,
                })
                .then(() => console.log('Successful share'))
                .catch((error) => console.log('Error sharing', error));
            } else {
                alert("Native sharing is not supported on this browser.");
            }
        }


        function showProfile() {
            const currentUrl = window.location.href;
            const shareText = encodeURIComponent("Check out this amazing portfolio!");
            const emailSubject = encodeURIComponent(document.title);
            const emailBody = encodeURIComponent(`Here's an interesting academic profile: ${currentUrl}`);
            const whatsappText = encodeURIComponent(`${shareText} ${currentUrl}`);

            const profileHTML = `
                <div class="min-h-screen bg-gradient-to-br from-teal-50 via-cyan-50 to-emerald-50">
                    <div class="bg-gradient-to-r from-teal-600 via-cyan-500 to-emerald-600 text-white relative overflow-hidden">
                        <div class="absolute inset-0 bg-black opacity-10"></div>
                        <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1.5'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
                        
                        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                            <a href="index.html" class="back-button inline-flex items-center text-white hover:text-gray-200 mb-8 px-4 py-2 rounded-xl backdrop-blur-sm bg-white bg-opacity-20">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                                Back to Directory
                            </a>
                            
                            <div class="flex flex-col lg:flex-row items-start lg:items-center space-y-6 lg:space-y-0 lg:space-x-8">
                                <div class="relative">
                                    <div class="w-40 h-40 rounded-3xl overflow-hidden shadow-2xl border-4 border-white border-opacity-30">
                                        <img src="${profileData.imageUrl}" alt="${profileData.name}" class="w-full h-full object-cover">
                                    </div>
                                    <div class="absolute -bottom-4 -right-4 w-16 h-16 bg-teal-400 rounded-full border-4 border-white flex items-center justify-center shadow-lg">
                                         <svg class="w-8 h-8 text-teal-900" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="flex-1">
                                    <h1 class="text-5xl lg:text-6xl font-bold mb-3 leading-tight">${profileData.name}</h1>
                                    <p class="text-2xl text-teal-100 mb-2 font-medium">${profileData.title}</p>
                                    <p class="text-xl text-cyan-100 mb-4">${profileData.institution}</p>
                                    <div class="flex flex-wrap gap-3 mb-6">
                                        <span class="bg-teal-400 text-teal-900 px-4 py-2 rounded-full text-sm font-bold">
                                            📈 Halal Marketing Expert
                                        </span>
                                        <span class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-medium backdrop-blur-sm">
                                            🎓 PhD in Technology Management
                                        </span>
                                        <span class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-medium backdrop-blur-sm">
                                            🏆 UiTM Top Talent 2022
                                        </span>
                                    </div>
                                    <div class="flex items-center space-x-4 my-6">
                                        <a href="https://expert.uitm.edu.my/V2/page-detail.php?id=WzvhFjKzJmKNVhq50NKexyYBqaVyMpxfHTU4OyY2Rp4%3D" target="_blank" rel="noopener noreferrer" title="UiTM Expert" class="text-white p-2 rounded-full bg-white bg-opacity-20 hover:bg-opacity-30 transition-all duration-300 transform hover:scale-110">
                                            <img src="https://i.imgur.com/lspSvPG.png" alt="UiTM Expert" class="w-12 h-12">
                                        </a>
                                        <a href="https://scholar.google.com/citations?user=LZ7JqvoAAAAJ&hl=en" target="_blank" rel="noopener noreferrer" title="Google Scholar link" class="text-white p-2 rounded-full bg-white bg-opacity-20 hover:bg-opacity-30 transition-all duration-300 transform hover:scale-110">
                                            <img src="https://i.imgur.com/mYgMKZM.png" alt="Google Scholar" class="w-10 h-10">
                                        </a>
                                        <a href="https://orcid.org/0000-0002-7824-8087" target="_blank" rel="noopener noreferrer" title="OrcId" class="text-white p-2 rounded-full bg-white bg-opacity-20 hover:bg-opacity-30 transition-all duration-300 transform hover:scale-110">
                                            <img src="https://i.imgur.com/E1qAhFM.png" alt="ORCID" class="w-10 h-10">
                                        </a>
                                    </div>
                                
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 -mt-8 relative z-20">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div class="lg:col-span-2 space-y-8">
                                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-8">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                                         <svg class="w-6 h-6 mr-3 text-teal-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                                        Professional Summary
                                    </h2>
                                    <div class="p-6 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl border-l-4 border-teal-500">
                                        <p class="text-gray-700 text-lg leading-relaxed">${profileData.summary}</p>
                                    </div>
                                </div>

                                 <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-8">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                                         <svg class="w-6 h-6 mr-3 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                                        Core Research Pillars
                                    </h2>
                                    <div class="space-y-6">
                                        ${profileData.research_pillars.map((pillar, index) => `
                                            <div class="p-6 bg-gradient-to-r from-cyan-50 to-emerald-50 rounded-xl border-l-4 border-cyan-500">
                                                <h3 class="text-lg font-bold text-gray-900 mb-3">${pillar.pillar}</h3>
                                                <p class="text-gray-700 leading-relaxed">${pillar.description}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-8">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                                        <svg class="w-6 h-6 mr-3 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                                        Scholarly Impact & Key Publications
                                    </h2>
                                    
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 text-center">
                                        <div class="p-4 bg-teal-50 rounded-xl border-2 border-teal-100">
                                            <div class="text-3xl font-bold text-teal-600">${profileData.scholarly_impact.metrics.google_scholar_citations}</div>
                                            <div class="text-sm text-teal-700 font-medium">Citations</div>
                                        </div>
                                        <div class="p-4 bg-cyan-50 rounded-xl border-2 border-cyan-100">
                                            <div class="text-3xl font-bold text-cyan-600">${profileData.scholarly_impact.metrics.h_index_google}</div>
                                            <div class="text-sm text-cyan-700 font-medium">H-Index</div>
                                        </div>
                                        <div class="p-4 bg-emerald-50 rounded-xl border-2 border-emerald-100">
                                            <div class="text-3xl font-bold text-emerald-600">${profileData.scholarly_impact.metrics.citations_since_2020}</div>
                                            <div class="text-sm text-emerald-700 font-medium">Citations since 2020</div>
                                        </div>
                                        <div class="p-4 bg-gray-50 rounded-xl border-2 border-gray-100">
                                            <div class="text-3xl font-bold text-gray-600">464</div>
                                            <div class="text-sm text-gray-700 font-medium">Top Paper Citations</div>
                                        </div>
                                    </div>

                                     <div class="space-y-4">
                                        ${profileData.key_publications.map((pub, index) => {
                                             const badgeColors = { landmark: 'bg-yellow-400 text-yellow-900', key: 'bg-teal-400 text-teal-900', regional: 'bg-cyan-400 text-cyan-900' };
                                            return `
                                                <div class="p-4 bg-gray-50 rounded-xl border-l-4 border-gray-300">
                                                    <div class="flex items-start justify-between mb-2">
                                                        <h4 class="font-bold text-gray-900 text-md leading-tight flex-1 mr-4">"${pub.title}"</h4>
                                                        <span class="px-3 py-1 ${badgeColors[pub.significance]} rounded-full text-xs font-bold flex-shrink-0">${pub.citations} Citations</span>
                                                    </div>
                                                     <p class="text-xs text-gray-600 font-medium">${pub.journal} (${pub.year})</p>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>
                            </div>

                            <div class="space-y-8">
                                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-6">
                                    <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 mr-2 text-teal-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2V6"></path></svg>
                                        Academic Journey
                                    </h3>
                                    <div class="space-y-3">
                                        ${profileData.education.map(edu => `
                                            <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-gray-400">
                                                <p class="text-sm font-bold text-gray-900">${edu.degree}</p>
                                                <p class="text-xs text-gray-600">${edu.institution}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-6">
                                     <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                         <svg class="w-5 h-5 mr-2 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                                        Leadership & Service
                                    </h3>
                                    <div class="space-y-4">
                                        <div>
                                            <h4 class="font-semibold text-gray-700 mb-2">Institutional Roles</h4>
                                            ${profileData.leadership_and_service.institutional.map(item => `<div class="flex items-center p-2 bg-teal-50 rounded-lg"><div class="w-2 h-2 bg-teal-500 rounded-full mr-3"></div><span class="text-sm text-gray-700">${item}</span></div>`).join('')}
                                        </div>
                                         <div>
                                            <h4 class="font-semibold text-gray-700 mb-2">Community & Professional</h4>
                                            ${profileData.leadership_and_service.community.map(item => `<div class="flex items-center p-2 bg-cyan-50 rounded-lg"><div class="w-2 h-2 bg-cyan-500 rounded-full mr-3"></div><span class="text-sm text-gray-700">${item}</span></div>`).join('')}
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-6">
                                    <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                                        <svg class="w-5 h-5 mr-2 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg>
                                        Awards & Innovations
                                    </h3>
                                    <div class="space-y-2">
                                        ${profileData.awards_and_innovations.map(award => `
                                            <div class="flex items-start p-2 bg-emerald-50 rounded-lg">
                                                <div class="w-2 h-2 bg-emerald-500 rounded-full mr-3 mt-1.5 flex-shrink-0"></div>
                                                <span class="text-sm text-gray-700">${award}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                    <button 
                        onclick="toggleShare()" 
                        aria-label="Share this profile"
                        class="fixed bottom-8 right-8 bg-gradient-to-r from-teal-500 to-green-500 text-white p-4 rounded-full shadow-lg z-40 hover:shadow-xl transition-all duration-300 hover:scale-110">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-5.367m0 5.367a3 3 0 110-5.367m0 5.367a3 3 0 110-5.367"/>
                        </svg>
                    </button>

                    <div id="sharePanel" class="fixed right-0 top-1/2 -translate-y-1/2 bg-white shadow-2xl rounded-l-2xl p-6 w-72 z-50 transform translate-x-full transition-transform duration-500 ease-in-out">
                        <button onclick="toggleShare()" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl font-bold">×</button>
                        <h3 class="font-bold text-gray-800 mb-4 text-lg">Share this profile</h3>
                        <div class="space-y-3">
                            <a href="https://www.facebook.com/sharer/sharer.php?u=${currentUrl}" target="_blank" rel="noopener noreferrer" class="flex items-center space-x-3 p-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                                <span>Facebook</span>
                            </a>
                            <a href="https://twitter.com/intent/tweet?url=${currentUrl}&text=${shareText}" target="_blank" rel="noopener noreferrer" class="flex items-center space-x-3 p-3 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                                <span>X (Twitter)</span>
                            </a>
                            <a href="https://www.linkedin.com/sharing/share-offsite/?url=${currentUrl}" target="_blank" rel="noopener noreferrer" class="flex items-center space-x-3 p-3 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                                <span>LinkedIn</span>
                            </a>
                            <a href="https://api.whatsapp.com/send?text=${whatsappText}" target="_blank" rel="noopener noreferrer" class="flex items-center space-x-3 p-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/></svg>
                                <span>WhatsApp</span>
                            </a>
                            <a href="mailto:?subject=${emailSubject}&body=${emailBody}" class="flex items-center space-x-3 p-3 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                                <span>Email</span>
                            </a>

                            <hr class="my-4">

                            <div class="flex justify-center mt-4">
                                <div id="qr-code"></div>
                            </div>
                            <p class="text-center text-sm text-gray-600 mt-2">Scan or Download QR</p>

                            <button onclick="downloadQR()" class="flex items-center justify-center space-x-2 w-full mt-3 p-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                <span>Download QR Code</span>
                            </button>
                            
                            ${navigator.share ? `
                            <button onclick="shareLinkNative()" class="flex items-center justify-center space-x-2 w-full mt-3 p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"></path></svg>
                                <span>Share Link...</span>
                            </button>
                            ` : ''}

                        </div>
                    </div>

            `;
            document.getElementById('profileView').innerHTML = profileHTML;

            try {
                // *** ENHANCEMENT: Assign to the global instance ***
                qrCodeInstance = new QRCodeStyling({
                    width: 200,
                    height: 200,
                    type: "svg",
                    data: window.location.href,
                    dotsOptions: {
                        color: "#0d9488",
                        type: "rounded"
                    },
                    backgroundOptions: {
                        color: "#f1f5f9",
                    },
                    imageOptions: {
                        crossOrigin: "anonymous",
                        margin: 10
                    },
                    cornersSquareOptions: {
                        type: "extra-rounded",
                        color: "#15803d"
                    },
                    cornersDotOptions: {
                        color: "#059669"
                    }
                });
                qrCodeInstance.append(document.getElementById("qr-code"));
            } catch (e) {
                console.error("Could not create QR code:", e);
                const qrElement = document.getElementById("qr-code");
                if(qrElement) qrElement.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', showProfile);
    </script>
</body>
</html>
